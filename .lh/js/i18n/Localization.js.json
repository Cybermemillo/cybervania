{
    "sourceFile": "js/i18n/Localization.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1741031694798,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1741033156156,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,358 @@\n+/**\r\n+ * Sistema de localización para Cybervania\r\n+ * Gestiona los textos en diferentes idiomas\r\n+ */\r\n+export class Localization {\r\n+    constructor() {\r\n+        // Idioma actual del juego\r\n+        this.currentLanguage = 'es';\r\n+        \r\n+        // Textos disponibles por idioma\r\n+        this.translations = {\r\n+            // Español (idioma por defecto)\r\n+            'es': {\r\n+                // Menú principal\r\n+                'menu.newGame': 'Nueva Partida',\r\n+                'menu.loadGame': 'Cargar Partida',\r\n+                'menu.options': 'Opciones',\r\n+                'menu.exit': 'Salir',\r\n+                \r\n+                // Títulos de pantallas\r\n+                'screen.options': 'Opciones',\r\n+                'screen.newGame': 'Nueva Partida',\r\n+                'screen.loadGame': 'Cargar Partida',\r\n+                \r\n+                // Creación de personaje\r\n+                'character.name': 'Nombre de Hacker',\r\n+                'character.enterName': 'Ingresa tu nombre...',\r\n+                'character.identity': 'Selecciona tu identidad',\r\n+                'character.male': 'Hombre',\r\n+                'character.female': 'Mujer',\r\n+                'character.specialization': 'Especialización',\r\n+                'character.preview': 'Vista previa',\r\n+                'character.motivation': 'Motivación (opcional)',\r\n+                'character.motivationPlaceholder': 'Describe brevemente la motivación de tu personaje...',\r\n+                \r\n+                // Especializaciones\r\n+                'spec.redTeam': 'Red Team',\r\n+                'spec.redDesc': 'Especializado en ataque y penetración. Daño superior a costa de defensa.',\r\n+                'spec.blueTeam': 'Blue Team',\r\n+                'spec.blueDesc': 'Especializado en defensa y seguridad. Mayor resistencia y supervivencia.',\r\n+                'spec.purpleTeam': 'Purple Team',\r\n+                'spec.purpleDesc': 'Equilibrio entre ataque y defensa. Adaptabilidad y versatilidad táctica.',\r\n+                \r\n+                // Estadísticas\r\n+                'stat.health': 'Salud',\r\n+                'stat.defense': 'Defensa',\r\n+                'stat.attack': 'Ataque',\r\n+                'stat.actionPoints': 'Puntos de acción',\r\n+                \r\n+                // Opciones de juego\r\n+                'options.audio': 'Audio',\r\n+                'options.musicVolume': 'Volumen de música',\r\n+                'options.sfxVolume': 'Volumen de efectos',\r\n+                'options.display': 'Pantalla',\r\n+                'options.fullscreen': 'Pantalla completa',\r\n+                'options.visualQuality': 'Calidad visual',\r\n+                'options.targetFPS': 'FPS objetivo',\r\n+                'options.game': 'Juego',\r\n+                'options.difficulty': 'Dificultad',\r\n+                'options.language': 'Idioma',\r\n+                'options.accessibility': 'Accesibilidad',\r\n+                'options.highContrast': 'Alto contraste',\r\n+                'options.screenShake': 'Vibración de pantalla',\r\n+                \r\n+                // Valores de opciones\r\n+                'quality.low': 'Baja',\r\n+                'quality.medium': 'Media',\r\n+                'quality.high': 'Alta',\r\n+                'difficulty.easy': 'Fácil',\r\n+                'difficulty.normal': 'Normal',\r\n+                'difficulty.hard': 'Difícil',\r\n+                'fps.30': '30 FPS',\r\n+                'fps.60': '60 FPS',\r\n+                'fps.120': '120 FPS',\r\n+                'fps.unlimited': 'Sin límite',\r\n+                \r\n+                // Botones\r\n+                'button.saveChanges': 'Guardar Cambios',\r\n+                'button.cancel': 'Cancelar',\r\n+                'button.reset': 'Restablecer',\r\n+                'button.testSound': 'Probar Sonido',\r\n+                'button.start': 'Comenzar Partida',\r\n+                'button.back': 'Volver',\r\n+                \r\n+                // Notificaciones\r\n+                'notify.optionsSaved': 'Opciones guardadas correctamente',\r\n+                'notify.optionsReset': 'Opciones restablecidas',\r\n+                'notify.soundTest': 'Reproduciendo efecto de sonido',\r\n+                'notify.nameRequired': 'Debes ingresar un nombre',\r\n+                'notify.specRequired': 'Selecciona una especialización',\r\n+                \r\n+                // Partidas guardadas\r\n+                'save.empty': 'Slot vacío',\r\n+                'save.level': 'Nivel',\r\n+                \r\n+                // Confirmaciones\r\n+                'confirm.resetOptions': '¿Seguro que quieres restablecer todas las opciones a valores predeterminados?',\r\n+                'confirm.exit': '¿Seguro que quieres salir?'\r\n+            },\r\n+            \r\n+            // English\r\n+            'en': {\r\n+                // Main menu\r\n+                'menu.newGame': 'New Game',\r\n+                'menu.loadGame': 'Load Game',\r\n+                'menu.options': 'Options',\r\n+                'menu.exit': 'Exit',\r\n+                \r\n+                // Screen titles\r\n+                'screen.options': 'Options',\r\n+                'screen.newGame': 'New Game',\r\n+                'screen.loadGame': 'Load Game',\r\n+                \r\n+                // Character creation\r\n+                'character.name': 'Hacker Name',\r\n+                'character.enterName': 'Enter your name...',\r\n+                'character.identity': 'Select your identity',\r\n+                'character.male': 'Male',\r\n+                'character.female': 'Female',\r\n+                'character.specialization': 'Specialization',\r\n+                'character.preview': 'Preview',\r\n+                'character.motivation': 'Motivation (optional)',\r\n+                'character.motivationPlaceholder': 'Briefly describe your character\\'s motivation...',\r\n+                \r\n+                // Specializations\r\n+                'spec.redTeam': 'Red Team',\r\n+                'spec.redDesc': 'Specialized in attack and penetration. Superior damage at the cost of defense.',\r\n+                'spec.blueTeam': 'Blue Team',\r\n+                'spec.blueDesc': 'Specialized in defense and security. Greater resistance and survival.',\r\n+                'spec.purpleTeam': 'Purple Team',\r\n+                'spec.purpleDesc': 'Balance between attack and defense. Tactical adaptability and versatility.',\r\n+                \r\n+                // Stats\r\n+                'stat.health': 'Health',\r\n+                'stat.defense': 'Defense',\r\n+                'stat.attack': 'Attack',\r\n+                'stat.actionPoints': 'Action Points',\r\n+                \r\n+                // Game options\r\n+                'options.audio': 'Audio',\r\n+                'options.musicVolume': 'Music Volume',\r\n+                'options.sfxVolume': 'Effects Volume',\r\n+                'options.display': 'Display',\r\n+                'options.fullscreen': 'Fullscreen',\r\n+                'options.visualQuality': 'Visual Quality',\r\n+                'options.targetFPS': 'Target FPS',\r\n+                'options.game': 'Game',\r\n+                'options.difficulty': 'Difficulty',\r\n+                'options.language': 'Language',\r\n+                'options.accessibility': 'Accessibility',\r\n+                'options.highContrast': 'High Contrast',\r\n+                'options.screenShake': 'Screen Shake',\r\n+                \r\n+                // Option values\r\n+                'quality.low': 'Low',\r\n+                'quality.medium': 'Medium',\r\n+                'quality.high': 'High',\r\n+                'difficulty.easy': 'Easy',\r\n+                'difficulty.normal': 'Normal',\r\n+                'difficulty.hard': 'Hard',\r\n+                'fps.30': '30 FPS',\r\n+                'fps.60': '60 FPS',\r\n+                'fps.120': '120 FPS',\r\n+                'fps.unlimited': 'Unlimited',\r\n+                \r\n+                // Buttons\r\n+                'button.saveChanges': 'Save Changes',\r\n+                'button.cancel': 'Cancel',\r\n+                'button.reset': 'Reset',\r\n+                'button.testSound': 'Test Sound',\r\n+                'button.start': 'Start Game',\r\n+                'button.back': 'Back',\r\n+                \r\n+                // Notifications\r\n+                'notify.optionsSaved': 'Options saved successfully',\r\n+                'notify.optionsReset': 'Options reset to default values',\r\n+                'notify.soundTest': 'Playing sound effect',\r\n+                'notify.nameRequired': 'You must enter a name',\r\n+                'notify.specRequired': 'Select a specialization',\r\n+                \r\n+                // Save games\r\n+                'save.empty': 'Empty Slot',\r\n+                'save.level': 'Level',\r\n+                \r\n+                // Confirmations\r\n+                'confirm.resetOptions': 'Are you sure you want to reset all options to default values?',\r\n+                'confirm.exit': 'Are you sure you want to exit?'\r\n+            },\r\n+            \r\n+            // Français\r\n+            'fr': {\r\n+                // Menu principal\r\n+                'menu.newGame': 'Nouvelle Partie',\r\n+                'menu.loadGame': 'Charger Partie',\r\n+                'menu.options': 'Options',\r\n+                'menu.exit': 'Quitter',\r\n+                \r\n+                // Titres des écrans\r\n+                'screen.options': 'Options',\r\n+                'screen.newGame': 'Nouvelle Partie',\r\n+                'screen.loadGame': 'Charger Partie',\r\n+                \r\n+                // Création de personnage\r\n+                'character.name': 'Nom du Hacker',\r\n+                'character.enterName': 'Entrez votre nom...',\r\n+                'character.identity': 'Sélectionnez votre identité',\r\n+                'character.male': 'Homme',\r\n+                'character.female': 'Femme',\r\n+                'character.specialization': 'Spécialisation',\r\n+                'character.preview': 'Aperçu',\r\n+                'character.motivation': 'Motivation (optionnel)',\r\n+                'character.motivationPlaceholder': 'Décrivez brièvement la motivation de votre personnage...',\r\n+                \r\n+                // Spécialisations\r\n+                'spec.redTeam': 'Équipe Rouge',\r\n+                'spec.redDesc': 'Spécialisé dans l\\'attaque et la pénétration. Dégâts supérieurs au détriment de la défense.',\r\n+                'spec.blueTeam': 'Équipe Bleue',\r\n+                'spec.blueDesc': 'Spécialisé dans la défense et la sécurité. Plus grande résistance et survie.',\r\n+                'spec.purpleTeam': 'Équipe Violette',\r\n+                'spec.purpleDesc': 'Équilibre entre attaque et défense. Adaptabilité et versatilité tactique.',\r\n+                \r\n+                // Statistiques\r\n+                'stat.health': 'Santé',\r\n+                'stat.defense': 'Défense',\r\n+                'stat.attack': 'Attaque',\r\n+                'stat.actionPoints': 'Points d\\'action',\r\n+                \r\n+                // Options de jeu\r\n+                'options.audio': 'Audio',\r\n+                'options.musicVolume': 'Volume de musique',\r\n+                'options.sfxVolume': 'Volume d\\'effets',\r\n+                'options.display': 'Affichage',\r\n+                'options.fullscreen': 'Plein écran',\r\n+                'options.visualQuality': 'Qualité visuelle',\r\n+                'options.targetFPS': 'FPS cible',\r\n+                'options.game': 'Jeu',\r\n+                'options.difficulty': 'Difficulté',\r\n+                'options.language': 'Langue',\r\n+                'options.accessibility': 'Accessibilité',\r\n+                'options.highContrast': 'Contraste élevé',\r\n+                'options.screenShake': 'Tremblement d\\'écran',\r\n+                \r\n+                // Valeurs des options\r\n+                'quality.low': 'Basse',\r\n+                'quality.medium': 'Moyenne',\r\n+                'quality.high': 'Haute',\r\n+                'difficulty.easy': 'Facile',\r\n+                'difficulty.normal': 'Normal',\r\n+                'difficulty.hard': 'Difficile',\r\n+                'fps.30': '30 FPS',\r\n+                'fps.60': '60 FPS',\r\n+                'fps.120': '120 FPS',\r\n+                'fps.unlimited': 'Illimité',\r\n+                \r\n+                // Boutons\r\n+                'button.saveChanges': 'Enregistrer',\r\n+                'button.cancel': 'Annuler',\r\n+                'button.reset': 'Réinitialiser',\r\n+                'button.testSound': 'Tester Son',\r\n+                'button.start': 'Commencer',\r\n+                'button.back': 'Retour',\r\n+                \r\n+                // Notifications\r\n+                'notify.optionsSaved': 'Options enregistrées avec succès',\r\n+                'notify.optionsReset': 'Options réinitialisées',\r\n+                'notify.soundTest': 'Lecture de l\\'effet sonore',\r\n+                'notify.nameRequired': 'Vous devez entrer un nom',\r\n+                'notify.specRequired': 'Sélectionnez une spécialisation',\r\n+                \r\n+                // Parties sauvegardées\r\n+                'save.empty': 'Emplacement vide',\r\n+                'save.level': 'Niveau',\r\n+                \r\n+                // Confirmations\r\n+                'confirm.resetOptions': 'Êtes-vous sûr de vouloir réinitialiser toutes les options aux valeurs par défaut?',\r\n+                'confirm.exit': 'Êtes-vous sûr de vouloir quitter?'\r\n+            }\r\n+        };\r\n+    }\r\n+    \r\n+    /**\r\n+     * Cambia el idioma actual\r\n+     * @param {string} lang - Código de idioma ('es', 'en', 'fr')\r\n+     */\r\n+    setLanguage(lang) {\r\n+        if (this.translations[lang]) {\r\n+            this.currentLanguage = lang;\r\n+            document.documentElement.setAttribute('lang', lang);\r\n+            \r\n+            // Actualizar la clase del idioma en el body\r\n+            document.body.className = document.body.className\r\n+                .replace(/lang-[a-z]{2}/g, '')\r\n+                .trim();\r\n+            document.body.classList.add(`lang-${lang}`);\r\n+            \r\n+            // Disparar evento de cambio de idioma\r\n+            const event = new CustomEvent('languageChanged', { \r\n+                detail: { language: lang } \r\n+            });\r\n+            document.dispatchEvent(event);\r\n+            \r\n+            return true;\r\n+        }\r\n+        return false;\r\n+    }\r\n+    \r\n+    /**\r\n+     * Obtiene un texto traducido\r\n+     * @param {string} key - Clave de traducción \r\n+     * @param {Object} params - Parámetros para reemplazar en el texto\r\n+     * @returns {string} Texto traducido\r\n+     */\r\n+    getText(key, params = {}) {\r\n+        // Obtener traducción del idioma actual\r\n+        let text = this.translations[this.currentLanguage][key];\r\n+        \r\n+        // Si no existe, intentar con el idioma por defecto\r\n+        if (!text && this.currentLanguage !== 'es') {\r\n+            text = this.translations['es'][key];\r\n+        }\r\n+        \r\n+        // Si sigue sin existir, devolver la clave\r\n+        if (!text) {\r\n+            console.warn(`No se encontró traducción para: ${key}`);\r\n+            return key;\r\n+        }\r\n+        \r\n+        // Reemplazar parámetros si hay\r\n+        if (params) {\r\n+            Object.keys(params).forEach(param => {\r\n+                text = text.replace(`{${param}}`, params[param]);\r\n+            });\r\n+        }\r\n+        \r\n+        return text;\r\n+    }\r\n+    \r\n+    /**\r\n+     * Traduce todos los elementos del DOM con atributo data-i18n\r\n+     */\r\n+    translatePage() {\r\n+        const elements = document.querySelectorAll('[data-i18n]');\r\n+        elements.forEach(element => {\r\n+            const key = element.dataset.i18n;\r\n+            element.textContent = this.getText(key);\r\n+        });\r\n+    }\r\n+}\r\n+\r\n+// Instancia singleton para toda la aplicación\r\n+let localizationInstance = null;\r\n+\r\n+export function getLocalization() {\r\n+    if (!localizationInstance) {\r\n+        localizationInstance = new Localization();\r\n+    }\r\n+    return localizationInstance;\r\n+}\r\n"
                },
                {
                    "date": 1741035054290,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,707 +1,95 @@\n /**\r\n  * Sistema de localización para Cybervania\r\n- * Gestiona los textos en diferentes idiomas\r\n  */\r\n-export class Localization {\r\n+import { es } from './es.js';\r\n+\r\n+class Localization {\r\n     constructor() {\r\n-        // Idioma actual del juego\r\n+        // Idiomas disponibles\r\n+        this.languages = {\r\n+            es: es\r\n+        };\r\n+        \r\n+        // Idioma actual (default español)\r\n         this.currentLanguage = 'es';\r\n         \r\n-        // Textos disponibles por idioma\r\n-        this.translations = {\r\n-            // Español (idioma por defecto)\r\n-            'es': {\r\n-                // Menú principal\r\n-                'menu.newGame': 'Nueva Partida',\r\n-                'menu.loadGame': 'Cargar Partida',\r\n-                'menu.options': 'Opciones',\r\n-                'menu.exit': 'Salir',\r\n-                \r\n-                // Títulos de pantallas\r\n-                'screen.options': 'Opciones',\r\n-                'screen.newGame': 'Nueva Partida',\r\n-                'screen.loadGame': 'Cargar Partida',\r\n-                \r\n-                // Creación de personaje\r\n-                'character.name': 'Nombre de Hacker',\r\n-                'character.enterName': 'Ingresa tu nombre...',\r\n-                'character.identity': 'Selecciona tu identidad',\r\n-                'character.male': 'Hombre',\r\n-                'character.female': 'Mujer',\r\n-                'character.specialization': 'Especialización',\r\n-                'character.preview': 'Vista previa',\r\n-                'character.motivation': 'Motivación (opcional)',\r\n-                'character.motivationPlaceholder': 'Describe brevemente la motivación de tu personaje...',\r\n-                \r\n-                // Especializaciones\r\n-                'spec.redTeam': 'Red Team',\r\n-                'spec.redDesc': 'Especializado en ataque y penetración. Daño superior a costa de defensa.',\r\n-                'spec.blueTeam': 'Blue Team',\r\n-                'spec.blueDesc': 'Especializado en defensa y seguridad. Mayor resistencia y supervivencia.',\r\n-                'spec.purpleTeam': 'Purple Team',\r\n-                'spec.purpleDesc': 'Equilibrio entre ataque y defensa. Adaptabilidad y versatilidad táctica.',\r\n-                \r\n-                // Estadísticas\r\n-                'stat.health': 'Salud',\r\n-                'stat.defense': 'Defensa',\r\n-                'stat.attack': 'Ataque',\r\n-                'stat.actionPoints': 'Puntos de acción',\r\n-                \r\n-                // Opciones de juego\r\n-                'options.audio': 'Audio',\r\n-                'options.musicVolume': 'Volumen de música',\r\n-                'options.sfxVolume': 'Volumen de efectos',\r\n-                'options.display': 'Pantalla',\r\n-                'options.fullscreen': 'Pantalla completa',\r\n-                'options.visualQuality': 'Calidad visual',\r\n-                'options.targetFPS': 'FPS objetivo',\r\n-                'options.game': 'Juego',\r\n-                'options.difficulty': 'Dificultad',\r\n-                'options.language': 'Idioma',\r\n-                'options.accessibility': 'Accesibilidad',\r\n-                'options.highContrast': 'Alto contraste',\r\n-                'options.screenShake': 'Vibración de pantalla',\r\n-                \r\n-                // Valores de opciones\r\n-                'quality.low': 'Baja',\r\n-                'quality.medium': 'Media',\r\n-                'quality.high': 'Alta',\r\n-                'difficulty.easy': 'Fácil',\r\n-                'difficulty.normal': 'Normal',\r\n-                'difficulty.hard': 'Difícil',\r\n-                'fps.30': '30 FPS',\r\n-                'fps.60': '60 FPS',\r\n-                'fps.120': '120 FPS',\r\n-                'fps.unlimited': 'Sin límite',\r\n-                \r\n-                // Botones\r\n-                'button.saveChanges': 'Guardar Cambios',\r\n-                'button.cancel': 'Cancelar',\r\n-                'button.reset': 'Restablecer',\r\n-                'button.testSound': 'Probar Sonido',\r\n-                'button.start': 'Comenzar Partida',\r\n-                'button.back': 'Volver',\r\n-                \r\n-                // Notificaciones\r\n-                'notify.optionsSaved': 'Opciones guardadas correctamente',\r\n-                'notify.optionsReset': 'Opciones restablecidas',\r\n-                'notify.soundTest': 'Reproduciendo efecto de sonido',\r\n-                'notify.nameRequired': 'Debes ingresar un nombre',\r\n-                'notify.specRequired': 'Selecciona una especialización',\r\n-                \r\n-                // Partidas guardadas\r\n-                'save.empty': 'Slot vacío',\r\n-                'save.level': 'Nivel',\r\n-                \r\n-                // Confirmaciones\r\n-                'confirm.resetOptions': '¿Seguro que quieres restablecer todas las opciones a valores predeterminados?',\r\n-                'confirm.exit': '¿Seguro que quieres salir?'\r\n-            },\r\n-            \r\n-            // English\r\n-            'en': {\r\n-                // Main menu\r\n-                'menu.newGame': 'New Game',\r\n-                'menu.loadGame': 'Load Game',\r\n-                'menu.options': 'Options',\r\n-                'menu.exit': 'Exit',\r\n-                \r\n-                // Screen titles\r\n-                'screen.options': 'Options',\r\n-                'screen.newGame': 'New Game',\r\n-                'screen.loadGame': 'Load Game',\r\n-                \r\n-                // Character creation\r\n-                'character.name': 'Hacker Name',\r\n-                'character.enterName': 'Enter your name...',\r\n-                'character.identity': 'Select your identity',\r\n-                'character.male': 'Male',\r\n-                'character.female': 'Female',\r\n-                'character.specialization': 'Specialization',\r\n-                'character.preview': 'Preview',\r\n-                'character.motivation': 'Motivation (optional)',\r\n-                'character.motivationPlaceholder': 'Briefly describe your character\\'s motivation...',\r\n-                \r\n-                // Specializations\r\n-                'spec.redTeam': 'Red Team',\r\n-                'spec.redDesc': 'Specialized in attack and penetration. Superior damage at the cost of defense.',\r\n-                'spec.blueTeam': 'Blue Team',\r\n-                'spec.blueDesc': 'Specialized in defense and security. Greater resistance and survival.',\r\n-                'spec.purpleTeam': 'Purple Team',\r\n-                'spec.purpleDesc': 'Balance between attack and defense. Tactical adaptability and versatility.',\r\n-                \r\n-                // Stats\r\n-                'stat.health': 'Health',\r\n-                'stat.defense': 'Defense',\r\n-                'stat.attack': 'Attack',\r\n-                'stat.actionPoints': 'Action Points',\r\n-                \r\n-                // Game options\r\n-                'options.audio': 'Audio',\r\n-                'options.musicVolume': 'Music Volume',\r\n-                'options.sfxVolume': 'Effects Volume',\r\n-                'options.display': 'Display',\r\n-                'options.fullscreen': 'Fullscreen',\r\n-                'options.visualQuality': 'Visual Quality',\r\n-                'options.targetFPS': 'Target FPS',\r\n-                'options.game': 'Game',\r\n-                'options.difficulty': 'Difficulty',\r\n-                'options.language': 'Language',\r\n-                'options.accessibility': 'Accessibility',\r\n-                'options.highContrast': 'High Contrast',\r\n-                'options.screenShake': 'Screen Shake',\r\n-                \r\n-                // Option values\r\n-                'quality.low': 'Low',\r\n-                'quality.medium': 'Medium',\r\n-                'quality.high': 'High',\r\n-                'difficulty.easy': 'Easy',\r\n-                'difficulty.normal': 'Normal',\r\n-                'difficulty.hard': 'Hard',\r\n-                'fps.30': '30 FPS',\r\n-                'fps.60': '60 FPS',\r\n-                'fps.120': '120 FPS',\r\n-                'fps.unlimited': 'Unlimited',\r\n-                \r\n-                // Buttons\r\n-                'button.saveChanges': 'Save Changes',\r\n-                'button.cancel': 'Cancel',\r\n-                'button.reset': 'Reset',\r\n-                'button.testSound': 'Test Sound',\r\n-                'button.start': 'Start Game',\r\n-                'button.back': 'Back',\r\n-                \r\n-                // Notifications\r\n-                'notify.optionsSaved': 'Options saved successfully',\r\n-                'notify.optionsReset': 'Options reset to default values',\r\n-                'notify.soundTest': 'Playing sound effect',\r\n-                'notify.nameRequired': 'You must enter a name',\r\n-                'notify.specRequired': 'Select a specialization',\r\n-                \r\n-                // Save games\r\n-                'save.empty': 'Empty Slot',\r\n-                'save.level': 'Level',\r\n-                \r\n-                // Confirmations\r\n-                'confirm.resetOptions': 'Are you sure you want to reset all options to default values?',\r\n-                'confirm.exit': 'Are you sure you want to exit?'\r\n-            },\r\n-            \r\n-            // Français\r\n-            'fr': {\r\n-                // Menu principal\r\n-                'menu.newGame': 'Nouvelle Partie',\r\n-                'menu.loadGame': 'Charger Partie',\r\n-                'menu.options': 'Options',\r\n-                'menu.exit': 'Quitter',\r\n-                \r\n-                // Titres des écrans\r\n-                'screen.options': 'Options',\r\n-                'screen.newGame': 'Nouvelle Partie',\r\n-                'screen.loadGame': 'Charger Partie',\r\n-                \r\n-                // Création de personnage\r\n-                'character.name': 'Nom du Hacker',\r\n-                'character.enterName': 'Entrez votre nom...',\r\n-                'character.identity': 'Sélectionnez votre identité',\r\n-                'character.male': 'Homme',\r\n-                'character.female': 'Femme',\r\n-                'character.specialization': 'Spécialisation',\r\n-                'character.preview': 'Aperçu',\r\n-                'character.motivation': 'Motivation (optionnel)',\r\n-                'character.motivationPlaceholder': 'Décrivez brièvement la motivation de votre personnage...',\r\n-                \r\n-                // Spécialisations\r\n-                'spec.redTeam': 'Équipe Rouge',\r\n-                'spec.redDesc': 'Spécialisé dans l\\'attaque et la pénétration. Dégâts supérieurs au détriment de la défense.',\r\n-                'spec.blueTeam': 'Équipe Bleue',\r\n-                'spec.blueDesc': 'Spécialisé dans la défense et la sécurité. Plus grande résistance et survie.',\r\n-                'spec.purpleTeam': 'Équipe Violette',\r\n-                'spec.purpleDesc': 'Équilibre entre attaque et défense. Adaptabilité et versatilité tactique.',\r\n-                \r\n-                // Statistiques\r\n-                'stat.health': 'Santé',\r\n-                'stat.defense': 'Défense',\r\n-                'stat.attack': 'Attaque',\r\n-                'stat.actionPoints': 'Points d\\'action',\r\n-                \r\n-                // Options de jeu\r\n-                'options.audio': 'Audio',\r\n-                'options.musicVolume': 'Volume de musique',\r\n-                'options.sfxVolume': 'Volume d\\'effets',\r\n-                'options.display': 'Affichage',\r\n-                'options.fullscreen': 'Plein écran',\r\n-                'options.visualQuality': 'Qualité visuelle',\r\n-                'options.targetFPS': 'FPS cible',\r\n-                'options.game': 'Jeu',\r\n-                'options.difficulty': 'Difficulté',\r\n-                'options.language': 'Langue',\r\n-                'options.accessibility': 'Accessibilité',\r\n-                'options.highContrast': 'Contraste élevé',\r\n-                'options.screenShake': 'Tremblement d\\'écran',\r\n-                \r\n-                // Valeurs des options\r\n-                'quality.low': 'Basse',\r\n-                'quality.medium': 'Moyenne',\r\n-                'quality.high': 'Haute',\r\n-                'difficulty.easy': 'Facile',\r\n-                'difficulty.normal': 'Normal',\r\n-                'difficulty.hard': 'Difficile',\r\n-                'fps.30': '30 FPS',\r\n-                'fps.60': '60 FPS',\r\n-                'fps.120': '120 FPS',\r\n-                'fps.unlimited': 'Illimité',\r\n-                \r\n-                // Boutons\r\n-                'button.saveChanges': 'Enregistrer',\r\n-                'button.cancel': 'Annuler',\r\n-                'button.reset': 'Réinitialiser',\r\n-                'button.testSound': 'Tester Son',\r\n-                'button.start': 'Commencer',\r\n-                'button.back': 'Retour',\r\n-                \r\n-                // Notifications\r\n-                'notify.optionsSaved': 'Options enregistrées avec succès',\r\n-                'notify.optionsReset': 'Options réinitialisées',\r\n-                'notify.soundTest': 'Lecture de l\\'effet sonore',\r\n-                'notify.nameRequired': 'Vous devez entrer un nom',\r\n-                'notify.specRequired': 'Sélectionnez une spécialisation',\r\n-                \r\n-                // Parties sauvegardées\r\n-                'save.empty': 'Emplacement vide',\r\n-                'save.level': 'Niveau',\r\n-                \r\n-                // Confirmations\r\n-                'confirm.resetOptions': 'Êtes-vous sûr de vouloir réinitialiser toutes les options aux valeurs par défaut?',\r\n-                'confirm.exit': 'Êtes-vous sûr de vouloir quitter?'\r\n-            }\r\n-        };\r\n+        // Callbacks para actualizar la UI cuando cambia el idioma\r\n+        this.onLanguageChangeCallbacks = [];\r\n     }\r\n     \r\n     /**\r\n-     * Cambia el idioma actual\r\n-     * @param {string} lang - Código de idioma ('es', 'en', 'fr')\r\n+     * Obtiene un texto localizado\r\n      */\r\n-    setLanguage(lang) {\r\n-        if (this.translations[lang]) {\r\n-            this.currentLanguage = lang;\r\n-            document.documentElement.setAttribute('lang', lang);\r\n-            \r\n-            // Actualizar la clase del idioma en el body\r\n-            document.body.className = document.body.className\r\n-                .replace(/lang-[a-z]{2}/g, '')\r\n-                .trim();\r\n-            document.body.classList.add(`lang-${lang}`);\r\n-            \r\n-            // Disparar evento de cambio de idioma\r\n-            const event = new CustomEvent('languageChanged', { \r\n-                detail: { language: lang } \r\n-            });\r\n-            document.dispatchEvent(event);\r\n-            \r\n-            return true;\r\n-        }\r\n-        return false;\r\n-    }\r\n-    \r\n-    /**\r\n-     * Obtiene un texto traducido\r\n-     * @param {string} key - Clave de traducción \r\n-     * @param {Object} params - Parámetros para reemplazar en el texto\r\n-     * @returns {string} Texto traducido\r\n-     */\r\n-    getText(key, params = {}) {\r\n-        // Obtener traducción del idioma actual\r\n-        let text = this.translations[this.currentLanguage][key];\r\n+    get(key) {\r\n+        // Clave puede ser en formato 'category.subcategory.item'\r\n+        const keys = key.split('.');\r\n+        let text = this.languages[this.currentLanguage];\r\n         \r\n-        // Si no existe, intentar con el idioma por defecto\r\n-        if (!text && this.currentLanguage !== 'es') {\r\n-            text = this.translations['es'][key];\r\n+        for (const k of keys) {\r\n+            if (text && text[k] !== undefined) {\r\n+                text = text[k];\r\n+            } else {\r\n+                console.warn(`Text key not found: ${key}`);\r\n+                return key; // Devuelve la clave como fallback\r\n+            }\r\n         }\r\n         \r\n-        // Si sigue sin existir, devolver la clave\r\n-        if (!text) {\r\n-            console.warn(`No se encontró traducción para: ${key}`);\r\n-            return key;\r\n-        }\r\n-        \r\n-        // Reemplazar parámetros si hay\r\n-        if (params) {\r\n-            Object.keys(params).forEach(param => {\r\n-                text = text.replace(`{${param}}`, params[param]);\r\n-            });\r\n-        }\r\n-        \r\n         return text;\r\n     }\r\n     \r\n     /**\r\n-     * Traduce todos los elementos del DOM con atributo data-i18n\r\n+     * Establece el idioma actual\r\n      */\r\n-    translatePage() {\r\n-        const elements = document.querySelectorAll('[data-i18n]');\r\n-        elements.forEach(element => {\r\n-            const key = element.dataset.i18n;\r\n-            element.textContent = this.getText(key);\r\n-        });\r\n-    }\r\n-}\r\n-\r\n-// Instancia singleton para toda la aplicación\r\n-let localizationInstance = null;\r\n-\r\n-export function getLocalization() {\r\n-    if (!localizationInstance) {\r\n-        localizationInstance = new Localization();\r\n-    }\r\n-    return localizationInstance;\r\n-}\r\n-/**\r\n- * Sistema de localización para Cybervania\r\n- * Gestiona los textos en diferentes idiomas\r\n- */\r\n-export class Localization {\r\n-    constructor() {\r\n-        // Idioma actual del juego\r\n-        this.currentLanguage = 'es';\r\n-        \r\n-        // Textos disponibles por idioma\r\n-        this.translations = {\r\n-            // Español (idioma por defecto)\r\n-            'es': {\r\n-                // Menú principal\r\n-                'menu.newGame': 'Nueva Partida',\r\n-                'menu.loadGame': 'Cargar Partida',\r\n-                'menu.options': 'Opciones',\r\n-                'menu.exit': 'Salir',\r\n-                \r\n-                // Títulos de pantallas\r\n-                'screen.options': 'Opciones',\r\n-                'screen.newGame': 'Nueva Partida',\r\n-                'screen.loadGame': 'Cargar Partida',\r\n-                \r\n-                // Creación de personaje\r\n-                'character.name': 'Nombre de Hacker',\r\n-                'character.enterName': 'Ingresa tu nombre...',\r\n-                'character.identity': 'Selecciona tu identidad',\r\n-                'character.male': 'Hombre',\r\n-                'character.female': 'Mujer',\r\n-                'character.specialization': 'Especialización',\r\n-                'character.preview': 'Vista previa',\r\n-                'character.motivation': 'Motivación (opcional)',\r\n-                'character.motivationPlaceholder': 'Describe brevemente la motivación de tu personaje...',\r\n-                \r\n-                // Especializaciones\r\n-                'spec.redTeam': 'Red Team',\r\n-                'spec.redDesc': 'Especializado en ataque y penetración. Daño superior a costa de defensa.',\r\n-                'spec.blueTeam': 'Blue Team',\r\n-                'spec.blueDesc': 'Especializado en defensa y seguridad. Mayor resistencia y supervivencia.',\r\n-                'spec.purpleTeam': 'Purple Team',\r\n-                'spec.purpleDesc': 'Equilibrio entre ataque y defensa. Adaptabilidad y versatilidad táctica.',\r\n-                \r\n-                // Estadísticas\r\n-                'stat.health': 'Salud',\r\n-                'stat.defense': 'Defensa',\r\n-                'stat.attack': 'Ataque',\r\n-                'stat.actionPoints': 'Puntos de acción',\r\n-                \r\n-                // Opciones de juego\r\n-                'options.audio': 'Audio',\r\n-                'options.musicVolume': 'Volumen de música',\r\n-                'options.sfxVolume': 'Volumen de efectos',\r\n-                'options.display': 'Pantalla',\r\n-                'options.fullscreen': 'Pantalla completa',\r\n-                'options.visualQuality': 'Calidad visual',\r\n-                'options.targetFPS': 'FPS objetivo',\r\n-                'options.game': 'Juego',\r\n-                'options.difficulty': 'Dificultad',\r\n-                'options.language': 'Idioma',\r\n-                'options.accessibility': 'Accesibilidad',\r\n-                'options.highContrast': 'Alto contraste',\r\n-                'options.screenShake': 'Vibración de pantalla',\r\n-                \r\n-                // Valores de opciones\r\n-                'quality.low': 'Baja',\r\n-                'quality.medium': 'Media',\r\n-                'quality.high': 'Alta',\r\n-                'difficulty.easy': 'Fácil',\r\n-                'difficulty.normal': 'Normal',\r\n-                'difficulty.hard': 'Difícil',\r\n-                'fps.30': '30 FPS',\r\n-                'fps.60': '60 FPS',\r\n-                'fps.120': '120 FPS',\r\n-                'fps.unlimited': 'Sin límite',\r\n-                \r\n-                // Botones\r\n-                'button.saveChanges': 'Guardar Cambios',\r\n-                'button.cancel': 'Cancelar',\r\n-                'button.reset': 'Restablecer',\r\n-                'button.testSound': 'Probar Sonido',\r\n-                'button.start': 'Comenzar Partida',\r\n-                'button.back': 'Volver',\r\n-                \r\n-                // Notificaciones\r\n-                'notify.optionsSaved': 'Opciones guardadas correctamente',\r\n-                'notify.optionsReset': 'Opciones restablecidas',\r\n-                'notify.soundTest': 'Reproduciendo efecto de sonido',\r\n-                'notify.nameRequired': 'Debes ingresar un nombre',\r\n-                'notify.specRequired': 'Selecciona una especialización',\r\n-                \r\n-                // Partidas guardadas\r\n-                'save.empty': 'Slot vacío',\r\n-                'save.level': 'Nivel',\r\n-                \r\n-                // Confirmaciones\r\n-                'confirm.resetOptions': '¿Seguro que quieres restablecer todas las opciones a valores predeterminados?',\r\n-                'confirm.exit': '¿Seguro que quieres salir?'\r\n-            },\r\n+    setLanguage(languageCode) {\r\n+        if (this.languages[languageCode]) {\r\n+            this.currentLanguage = languageCode;\r\n+            console.log(`Idioma cambiado a: ${languageCode}`);\r\n             \r\n-            // English\r\n-            'en': {\r\n-                // Main menu\r\n-                'menu.newGame': 'New Game',\r\n-                'menu.loadGame': 'Load Game',\r\n-                'menu.options': 'Options',\r\n-                'menu.exit': 'Exit',\r\n-                \r\n-                // Screen titles\r\n-                'screen.options': 'Options',\r\n-                'screen.newGame': 'New Game',\r\n-                'screen.loadGame': 'Load Game',\r\n-                \r\n-                // Character creation\r\n-                'character.name': 'Hacker Name',\r\n-                'character.enterName': 'Enter your name...',\r\n-                'character.identity': 'Select your identity',\r\n-                'character.male': 'Male',\r\n-                'character.female': 'Female',\r\n-                'character.specialization': 'Specialization',\r\n-                'character.preview': 'Preview',\r\n-                'character.motivation': 'Motivation (optional)',\r\n-                'character.motivationPlaceholder': 'Briefly describe your character\\'s motivation...',\r\n-                \r\n-                // Specializations\r\n-                'spec.redTeam': 'Red Team',\r\n-                'spec.redDesc': 'Specialized in attack and penetration. Superior damage at the cost of defense.',\r\n-                'spec.blueTeam': 'Blue Team',\r\n-                'spec.blueDesc': 'Specialized in defense and security. Greater resistance and survival.',\r\n-                'spec.purpleTeam': 'Purple Team',\r\n-                'spec.purpleDesc': 'Balance between attack and defense. Tactical adaptability and versatility.',\r\n-                \r\n-                // Stats\r\n-                'stat.health': 'Health',\r\n-                'stat.defense': 'Defense',\r\n-                'stat.attack': 'Attack',\r\n-                'stat.actionPoints': 'Action Points',\r\n-                \r\n-                // Game options\r\n-                'options.audio': 'Audio',\r\n-                'options.musicVolume': 'Music Volume',\r\n-                'options.sfxVolume': 'Effects Volume',\r\n-                'options.display': 'Display',\r\n-                'options.fullscreen': 'Fullscreen',\r\n-                'options.visualQuality': 'Visual Quality',\r\n-                'options.targetFPS': 'Target FPS',\r\n-                'options.game': 'Game',\r\n-                'options.difficulty': 'Difficulty',\r\n-                'options.language': 'Language',\r\n-                'options.accessibility': 'Accessibility',\r\n-                'options.highContrast': 'High Contrast',\r\n-                'options.screenShake': 'Screen Shake',\r\n-                \r\n-                // Option values\r\n-                'quality.low': 'Low',\r\n-                'quality.medium': 'Medium',\r\n-                'quality.high': 'High',\r\n-                'difficulty.easy': 'Easy',\r\n-                'difficulty.normal': 'Normal',\r\n-                'difficulty.hard': 'Hard',\r\n-                'fps.30': '30 FPS',\r\n-                'fps.60': '60 FPS',\r\n-                'fps.120': '120 FPS',\r\n-                'fps.unlimited': 'Unlimited',\r\n-                \r\n-                // Buttons\r\n-                'button.saveChanges': 'Save Changes',\r\n-                'button.cancel': 'Cancel',\r\n-                'button.reset': 'Reset',\r\n-                'button.testSound': 'Test Sound',\r\n-                'button.start': 'Start Game',\r\n-                'button.back': 'Back',\r\n-                \r\n-                // Notifications\r\n-                'notify.optionsSaved': 'Options saved successfully',\r\n-                'notify.optionsReset': 'Options reset to default values',\r\n-                'notify.soundTest': 'Playing sound effect',\r\n-                'notify.nameRequired': 'You must enter a name',\r\n-                'notify.specRequired': 'Select a specialization',\r\n-                \r\n-                // Save games\r\n-                'save.empty': 'Empty Slot',\r\n-                'save.level': 'Level',\r\n-                \r\n-                // Confirmations\r\n-                'confirm.resetOptions': 'Are you sure you want to reset all options to default values?',\r\n-                'confirm.exit': 'Are you sure you want to exit?'\r\n-            },\r\n+            // Notificar a los observadores\r\n+            this.notifyLanguageChange();\r\n             \r\n-            // Français\r\n-            'fr': {\r\n-                // Menu principal\r\n-                'menu.newGame': 'Nouvelle Partie',\r\n-                'menu.loadGame': 'Charger Partie',\r\n-                'menu.options': 'Options',\r\n-                'menu.exit': 'Quitter',\r\n+            // Guardar preferencia en localStorage\r\n+            try {\r\n+                let options = {};\r\n+                const savedOptions = localStorage.getItem('cybervania_options');\r\n+                if (savedOptions) {\r\n+                    options = JSON.parse(savedOptions);\r\n+                }\r\n                 \r\n-                // Titres des écrans\r\n-                'screen.options': 'Options',\r\n-                'screen.newGame': 'Nouvelle Partie',\r\n-                'screen.loadGame': 'Charger Partie',\r\n-                \r\n-                // Création de personnage\r\n-                'character.name': 'Nom du Hacker',\r\n-                'character.enterName': 'Entrez votre nom...',\r\n-                'character.identity': 'Sélectionnez votre identité',\r\n-                'character.male': 'Homme',\r\n-                'character.female': 'Femme',\r\n-                'character.specialization': 'Spécialisation',\r\n-                'character.preview': 'Aperçu',\r\n-                'character.motivation': 'Motivation (optionnel)',\r\n-                'character.motivationPlaceholder': 'Décrivez brièvement la motivation de votre personnage...',\r\n-                \r\n-                // Spécialisations\r\n-                'spec.redTeam': 'Équipe Rouge',\r\n-                'spec.redDesc': 'Spécialisé dans l\\'attaque et la pénétration. Dégâts supérieurs au détriment de la défense.',\r\n-                'spec.blueTeam': 'Équipe Bleue',\r\n-                'spec.blueDesc': 'Spécialisé dans la défense et la sécurité. Plus grande résistance et survie.',\r\n-                'spec.purpleTeam': 'Équipe Violette',\r\n-                'spec.purpleDesc': 'Équilibre entre attaque et défense. Adaptabilité et versatilité tactique.',\r\n-                \r\n-                // Statistiques\r\n-                'stat.health': 'Santé',\r\n-                'stat.defense': 'Défense',\r\n-                'stat.attack': 'Attaque',\r\n-                'stat.actionPoints': 'Points d\\'action',\r\n-                \r\n-                // Options de jeu\r\n-                'options.audio': 'Audio',\r\n-                'options.musicVolume': 'Volume de musique',\r\n-                'options.sfxVolume': 'Volume d\\'effets',\r\n-                'options.display': 'Affichage',\r\n-                'options.fullscreen': 'Plein écran',\r\n-                'options.visualQuality': 'Qualité visuelle',\r\n-                'options.targetFPS': 'FPS cible',\r\n-                'options.game': 'Jeu',\r\n-                'options.difficulty': 'Difficulté',\r\n-                'options.language': 'Langue',\r\n-                'options.accessibility': 'Accessibilité',\r\n-                'options.highContrast': 'Contraste élevé',\r\n-                'options.screenShake': 'Tremblement d\\'écran',\r\n-                \r\n-                // Valeurs des options\r\n-                'quality.low': 'Basse',\r\n-                'quality.medium': 'Moyenne',\r\n-                'quality.high': 'Haute',\r\n-                'difficulty.easy': 'Facile',\r\n-                'difficulty.normal': 'Normal',\r\n-                'difficulty.hard': 'Difficile',\r\n-                'fps.30': '30 FPS',\r\n-                'fps.60': '60 FPS',\r\n-                'fps.120': '120 FPS',\r\n-                'fps.unlimited': 'Illimité',\r\n-                \r\n-                // Boutons\r\n-                'button.saveChanges': 'Enregistrer',\r\n-                'button.cancel': 'Annuler',\r\n-                'button.reset': 'Réinitialiser',\r\n-                'button.testSound': 'Tester Son',\r\n-                'button.start': 'Commencer',\r\n-                'button.back': 'Retour',\r\n-                \r\n-                // Notifications\r\n-                'notify.optionsSaved': 'Options enregistrées avec succès',\r\n-                'notify.optionsReset': 'Options réinitialisées',\r\n-                'notify.soundTest': 'Lecture de l\\'effet sonore',\r\n-                'notify.nameRequired': 'Vous devez entrer un nom',\r\n-                'notify.specRequired': 'Sélectionnez une spécialisation',\r\n-                \r\n-                // Parties sauvegardées\r\n-                'save.empty': 'Emplacement vide',\r\n-                'save.level': 'Niveau',\r\n-                \r\n-                // Confirmations\r\n-                'confirm.resetOptions': 'Êtes-vous sûr de vouloir réinitialiser toutes les options aux valeurs par défaut?',\r\n-                'confirm.exit': 'Êtes-vous sûr de vouloir quitter?'\r\n+                options.language = languageCode;\r\n+                localStorage.setItem('cybervania_options', JSON.stringify(options));\r\n+            } catch (e) {\r\n+                console.error('Error guardando preferencia de idioma:', e);\r\n             }\r\n-        };\r\n-    }\r\n-    \r\n-    /**\r\n-     * Cambia el idioma actual\r\n-     * @param {string} lang - Código de idioma ('es', 'en', 'fr')\r\n-     */\r\n-    setLanguage(lang) {\r\n-        if (this.translations[lang]) {\r\n-            this.currentLanguage = lang;\r\n-            document.documentElement.setAttribute('lang', lang);\r\n             \r\n-            // Actualizar la clase del idioma en el body\r\n-            document.body.className = document.body.className\r\n-                .replace(/lang-[a-z]{2}/g, '')\r\n-                .trim();\r\n-            document.body.classList.add(`lang-${lang}`);\r\n-            \r\n-            // Disparar evento de cambio de idioma\r\n-            const event = new CustomEvent('languageChanged', { \r\n-                detail: { language: lang } \r\n-            });\r\n-            document.dispatchEvent(event);\r\n-            \r\n             return true;\r\n         }\r\n         return false;\r\n     }\r\n     \r\n     /**\r\n-     * Obtiene un texto traducido\r\n-     * @param {string} key - Clave de traducción \r\n-     * @param {Object} params - Parámetros para reemplazar en el texto\r\n-     * @returns {string} Texto traducido\r\n+     * Añade un callback para ser notificado cuando cambia el idioma\r\n      */\r\n-    getText(key, params = {}) {\r\n-        // Obtener traducción del idioma actual\r\n-        let text = this.translations[this.currentLanguage][key];\r\n-        \r\n-        // Si no existe, intentar con el idioma por defecto\r\n-        if (!text && this.currentLanguage !== 'es') {\r\n-            text = this.translations['es'][key];\r\n-        }\r\n-        \r\n-        // Si sigue sin existir, devolver la clave\r\n-        if (!text) {\r\n-            console.warn(`No se encontró traducción para: ${key}`);\r\n-            return key;\r\n-        }\r\n-        \r\n-        // Reemplazar parámetros si hay\r\n-        if (params) {\r\n-            Object.keys(params).forEach(param => {\r\n-                text = text.replace(`{${param}}`, params[param]);\r\n-            });\r\n-        }\r\n-        \r\n-        return text;\r\n+    addLanguageChangeCallback(callback) {\r\n+        this.onLanguageChangeCallbacks.push(callback);\r\n     }\r\n     \r\n     /**\r\n+     * Notifica a todos los callbacks registrados sobre el cambio de idioma\r\n+     */\r\n+    notifyLanguageChange() {\r\n+        this.onLanguageChangeCallbacks.forEach(callback => callback(this.currentLanguage));\r\n+    }\r\n+    \r\n+    /**\r\n      * Traduce todos los elementos del DOM con atributo data-i18n\r\n      */\r\n     translatePage() {\r\n         const elements = document.querySelectorAll('[data-i18n]');\r\n         elements.forEach(element => {\r\n             const key = element.dataset.i18n;\r\n-            element.textContent = this.getText(key);\r\n+            element.textContent = this.get(key);\r\n         });\r\n     }\r\n }\r\n \r\n"
                },
                {
                    "date": 1741035587217,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,9 +19,9 @@\n     \r\n     /**\r\n      * Obtiene un texto localizado\r\n      */\r\n-    get(key) {\r\n+    get(key, fallback = '') {\r\n         // Clave puede ser en formato 'category.subcategory.item'\r\n         const keys = key.split('.');\r\n         let text = this.languages[this.currentLanguage];\r\n         \r\n@@ -29,9 +29,9 @@\n             if (text && text[k] !== undefined) {\r\n                 text = text[k];\r\n             } else {\r\n                 console.warn(`Text key not found: ${key}`);\r\n-                return key; // Devuelve la clave como fallback\r\n+                return fallback || key; // Devuelve la clave o fallback como respaldo\r\n             }\r\n         }\r\n         \r\n         return text;\r\n@@ -63,42 +63,77 @@\n             }\r\n             \r\n             return true;\r\n         }\r\n+        \r\n         return false;\r\n     }\r\n     \r\n     /**\r\n-     * Añade un callback para ser notificado cuando cambia el idioma\r\n+     * Registra un callback para cuando cambie el idioma\r\n      */\r\n-    addLanguageChangeCallback(callback) {\r\n-        this.onLanguageChangeCallbacks.push(callback);\r\n+    onLanguageChange(callback) {\r\n+        if (typeof callback === 'function') {\r\n+            this.onLanguageChangeCallbacks.push(callback);\r\n+        }\r\n     }\r\n     \r\n     /**\r\n-     * Notifica a todos los callbacks registrados sobre el cambio de idioma\r\n+     * Notifica a todos los observers del cambio de idioma\r\n      */\r\n     notifyLanguageChange() {\r\n-        this.onLanguageChangeCallbacks.forEach(callback => callback(this.currentLanguage));\r\n+        this.onLanguageChangeCallbacks.forEach(callback => {\r\n+            try {\r\n+                callback(this.currentLanguage);\r\n+            } catch (e) {\r\n+                console.error('Error en callback de cambio de idioma:', e);\r\n+            }\r\n+        });\r\n     }\r\n     \r\n     /**\r\n-     * Traduce todos los elementos del DOM con atributo data-i18n\r\n+     * Función para formatear textos con variables\r\n+     * Ejemplo: format(\"Hola {0}, tienes {1} mensajes\", [\"Juan\", 5])\r\n      */\r\n-    translatePage() {\r\n-        const elements = document.querySelectorAll('[data-i18n]');\r\n-        elements.forEach(element => {\r\n-            const key = element.dataset.i18n;\r\n-            element.textContent = this.get(key);\r\n+    format(text, replacements) {\r\n+        if (!replacements || !Array.isArray(replacements)) {\r\n+            return text;\r\n+        }\r\n+        \r\n+        return text.replace(/{(\\d+)}/g, (match, index) => {\r\n+            return typeof replacements[index] !== 'undefined' ? replacements[index] : match;\r\n         });\r\n     }\r\n+    \r\n+    /**\r\n+     * Carga un nuevo paquete de idioma dinámicamente\r\n+     */\r\n+    async loadLanguage(languageCode) {\r\n+        if (this.languages[languageCode]) {\r\n+            return true; // Ya está cargado\r\n+        }\r\n+        \r\n+        try {\r\n+            const response = await fetch(`js/i18n/${languageCode}.js`);\r\n+            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);\r\n+            \r\n+            const langModule = await import(`./${languageCode}.js`);\r\n+            this.languages[languageCode] = langModule[languageCode];\r\n+            \r\n+            return true;\r\n+        } catch (e) {\r\n+            console.error(`Error cargando idioma ${languageCode}:`, e);\r\n+            return false;\r\n+        }\r\n+    }\r\n }\r\n \r\n-// Instancia singleton para toda la aplicación\r\n+// Singleton para manejar la localización en toda la aplicación\r\n let localizationInstance = null;\r\n \r\n export function getLocalization() {\r\n     if (!localizationInstance) {\r\n         localizationInstance = new Localization();\r\n     }\r\n+    \r\n     return localizationInstance;\r\n }\r\n"
                }
            ],
            "date": 1741031694798,
            "name": "Commit-0",
            "content": "/**\r\n * Sistema de localización para Cybervania\r\n * Gestiona los textos en diferentes idiomas\r\n */\r\nexport class Localization {\r\n    constructor() {\r\n        // Idioma actual del juego\r\n        this.currentLanguage = 'es';\r\n        \r\n        // Textos disponibles por idioma\r\n        this.translations = {\r\n            // Español (idioma por defecto)\r\n            'es': {\r\n                // Menú principal\r\n                'menu.newGame': 'Nueva Partida',\r\n                'menu.loadGame': 'Cargar Partida',\r\n                'menu.options': 'Opciones',\r\n                'menu.exit': 'Salir',\r\n                \r\n                // Títulos de pantallas\r\n                'screen.options': 'Opciones',\r\n                'screen.newGame': 'Nueva Partida',\r\n                'screen.loadGame': 'Cargar Partida',\r\n                \r\n                // Creación de personaje\r\n                'character.name': 'Nombre de Hacker',\r\n                'character.enterName': 'Ingresa tu nombre...',\r\n                'character.identity': 'Selecciona tu identidad',\r\n                'character.male': 'Hombre',\r\n                'character.female': 'Mujer',\r\n                'character.specialization': 'Especialización',\r\n                'character.preview': 'Vista previa',\r\n                'character.motivation': 'Motivación (opcional)',\r\n                'character.motivationPlaceholder': 'Describe brevemente la motivación de tu personaje...',\r\n                \r\n                // Especializaciones\r\n                'spec.redTeam': 'Red Team',\r\n                'spec.redDesc': 'Especializado en ataque y penetración. Daño superior a costa de defensa.',\r\n                'spec.blueTeam': 'Blue Team',\r\n                'spec.blueDesc': 'Especializado en defensa y seguridad. Mayor resistencia y supervivencia.',\r\n                'spec.purpleTeam': 'Purple Team',\r\n                'spec.purpleDesc': 'Equilibrio entre ataque y defensa. Adaptabilidad y versatilidad táctica.',\r\n                \r\n                // Estadísticas\r\n                'stat.health': 'Salud',\r\n                'stat.defense': 'Defensa',\r\n                'stat.attack': 'Ataque',\r\n                'stat.actionPoints': 'Puntos de acción',\r\n                \r\n                // Opciones de juego\r\n                'options.audio': 'Audio',\r\n                'options.musicVolume': 'Volumen de música',\r\n                'options.sfxVolume': 'Volumen de efectos',\r\n                'options.display': 'Pantalla',\r\n                'options.fullscreen': 'Pantalla completa',\r\n                'options.visualQuality': 'Calidad visual',\r\n                'options.targetFPS': 'FPS objetivo',\r\n                'options.game': 'Juego',\r\n                'options.difficulty': 'Dificultad',\r\n                'options.language': 'Idioma',\r\n                'options.accessibility': 'Accesibilidad',\r\n                'options.highContrast': 'Alto contraste',\r\n                'options.screenShake': 'Vibración de pantalla',\r\n                \r\n                // Valores de opciones\r\n                'quality.low': 'Baja',\r\n                'quality.medium': 'Media',\r\n                'quality.high': 'Alta',\r\n                'difficulty.easy': 'Fácil',\r\n                'difficulty.normal': 'Normal',\r\n                'difficulty.hard': 'Difícil',\r\n                'fps.30': '30 FPS',\r\n                'fps.60': '60 FPS',\r\n                'fps.120': '120 FPS',\r\n                'fps.unlimited': 'Sin límite',\r\n                \r\n                // Botones\r\n                'button.saveChanges': 'Guardar Cambios',\r\n                'button.cancel': 'Cancelar',\r\n                'button.reset': 'Restablecer',\r\n                'button.testSound': 'Probar Sonido',\r\n                'button.start': 'Comenzar Partida',\r\n                'button.back': 'Volver',\r\n                \r\n                // Notificaciones\r\n                'notify.optionsSaved': 'Opciones guardadas correctamente',\r\n                'notify.optionsReset': 'Opciones restablecidas',\r\n                'notify.soundTest': 'Reproduciendo efecto de sonido',\r\n                'notify.nameRequired': 'Debes ingresar un nombre',\r\n                'notify.specRequired': 'Selecciona una especialización',\r\n                \r\n                // Partidas guardadas\r\n                'save.empty': 'Slot vacío',\r\n                'save.level': 'Nivel',\r\n                \r\n                // Confirmaciones\r\n                'confirm.resetOptions': '¿Seguro que quieres restablecer todas las opciones a valores predeterminados?',\r\n                'confirm.exit': '¿Seguro que quieres salir?'\r\n            },\r\n            \r\n            // English\r\n            'en': {\r\n                // Main menu\r\n                'menu.newGame': 'New Game',\r\n                'menu.loadGame': 'Load Game',\r\n                'menu.options': 'Options',\r\n                'menu.exit': 'Exit',\r\n                \r\n                // Screen titles\r\n                'screen.options': 'Options',\r\n                'screen.newGame': 'New Game',\r\n                'screen.loadGame': 'Load Game',\r\n                \r\n                // Character creation\r\n                'character.name': 'Hacker Name',\r\n                'character.enterName': 'Enter your name...',\r\n                'character.identity': 'Select your identity',\r\n                'character.male': 'Male',\r\n                'character.female': 'Female',\r\n                'character.specialization': 'Specialization',\r\n                'character.preview': 'Preview',\r\n                'character.motivation': 'Motivation (optional)',\r\n                'character.motivationPlaceholder': 'Briefly describe your character\\'s motivation...',\r\n                \r\n                // Specializations\r\n                'spec.redTeam': 'Red Team',\r\n                'spec.redDesc': 'Specialized in attack and penetration. Superior damage at the cost of defense.',\r\n                'spec.blueTeam': 'Blue Team',\r\n                'spec.blueDesc': 'Specialized in defense and security. Greater resistance and survival.',\r\n                'spec.purpleTeam': 'Purple Team',\r\n                'spec.purpleDesc': 'Balance between attack and defense. Tactical adaptability and versatility.',\r\n                \r\n                // Stats\r\n                'stat.health': 'Health',\r\n                'stat.defense': 'Defense',\r\n                'stat.attack': 'Attack',\r\n                'stat.actionPoints': 'Action Points',\r\n                \r\n                // Game options\r\n                'options.audio': 'Audio',\r\n                'options.musicVolume': 'Music Volume',\r\n                'options.sfxVolume': 'Effects Volume',\r\n                'options.display': 'Display',\r\n                'options.fullscreen': 'Fullscreen',\r\n                'options.visualQuality': 'Visual Quality',\r\n                'options.targetFPS': 'Target FPS',\r\n                'options.game': 'Game',\r\n                'options.difficulty': 'Difficulty',\r\n                'options.language': 'Language',\r\n                'options.accessibility': 'Accessibility',\r\n                'options.highContrast': 'High Contrast',\r\n                'options.screenShake': 'Screen Shake',\r\n                \r\n                // Option values\r\n                'quality.low': 'Low',\r\n                'quality.medium': 'Medium',\r\n                'quality.high': 'High',\r\n                'difficulty.easy': 'Easy',\r\n                'difficulty.normal': 'Normal',\r\n                'difficulty.hard': 'Hard',\r\n                'fps.30': '30 FPS',\r\n                'fps.60': '60 FPS',\r\n                'fps.120': '120 FPS',\r\n                'fps.unlimited': 'Unlimited',\r\n                \r\n                // Buttons\r\n                'button.saveChanges': 'Save Changes',\r\n                'button.cancel': 'Cancel',\r\n                'button.reset': 'Reset',\r\n                'button.testSound': 'Test Sound',\r\n                'button.start': 'Start Game',\r\n                'button.back': 'Back',\r\n                \r\n                // Notifications\r\n                'notify.optionsSaved': 'Options saved successfully',\r\n                'notify.optionsReset': 'Options reset to default values',\r\n                'notify.soundTest': 'Playing sound effect',\r\n                'notify.nameRequired': 'You must enter a name',\r\n                'notify.specRequired': 'Select a specialization',\r\n                \r\n                // Save games\r\n                'save.empty': 'Empty Slot',\r\n                'save.level': 'Level',\r\n                \r\n                // Confirmations\r\n                'confirm.resetOptions': 'Are you sure you want to reset all options to default values?',\r\n                'confirm.exit': 'Are you sure you want to exit?'\r\n            },\r\n            \r\n            // Français\r\n            'fr': {\r\n                // Menu principal\r\n                'menu.newGame': 'Nouvelle Partie',\r\n                'menu.loadGame': 'Charger Partie',\r\n                'menu.options': 'Options',\r\n                'menu.exit': 'Quitter',\r\n                \r\n                // Titres des écrans\r\n                'screen.options': 'Options',\r\n                'screen.newGame': 'Nouvelle Partie',\r\n                'screen.loadGame': 'Charger Partie',\r\n                \r\n                // Création de personnage\r\n                'character.name': 'Nom du Hacker',\r\n                'character.enterName': 'Entrez votre nom...',\r\n                'character.identity': 'Sélectionnez votre identité',\r\n                'character.male': 'Homme',\r\n                'character.female': 'Femme',\r\n                'character.specialization': 'Spécialisation',\r\n                'character.preview': 'Aperçu',\r\n                'character.motivation': 'Motivation (optionnel)',\r\n                'character.motivationPlaceholder': 'Décrivez brièvement la motivation de votre personnage...',\r\n                \r\n                // Spécialisations\r\n                'spec.redTeam': 'Équipe Rouge',\r\n                'spec.redDesc': 'Spécialisé dans l\\'attaque et la pénétration. Dégâts supérieurs au détriment de la défense.',\r\n                'spec.blueTeam': 'Équipe Bleue',\r\n                'spec.blueDesc': 'Spécialisé dans la défense et la sécurité. Plus grande résistance et survie.',\r\n                'spec.purpleTeam': 'Équipe Violette',\r\n                'spec.purpleDesc': 'Équilibre entre attaque et défense. Adaptabilité et versatilité tactique.',\r\n                \r\n                // Statistiques\r\n                'stat.health': 'Santé',\r\n                'stat.defense': 'Défense',\r\n                'stat.attack': 'Attaque',\r\n                'stat.actionPoints': 'Points d\\'action',\r\n                \r\n                // Options de jeu\r\n                'options.audio': 'Audio',\r\n                'options.musicVolume': 'Volume de musique',\r\n                'options.sfxVolume': 'Volume d\\'effets',\r\n                'options.display': 'Affichage',\r\n                'options.fullscreen': 'Plein écran',\r\n                'options.visualQuality': 'Qualité visuelle',\r\n                'options.targetFPS': 'FPS cible',\r\n                'options.game': 'Jeu',\r\n                'options.difficulty': 'Difficulté',\r\n                'options.language': 'Langue',\r\n                'options.accessibility': 'Accessibilité',\r\n                'options.highContrast': 'Contraste élevé',\r\n                'options.screenShake': 'Tremblement d\\'écran',\r\n                \r\n                // Valeurs des options\r\n                'quality.low': 'Basse',\r\n                'quality.medium': 'Moyenne',\r\n                'quality.high': 'Haute',\r\n                'difficulty.easy': 'Facile',\r\n                'difficulty.normal': 'Normal',\r\n                'difficulty.hard': 'Difficile',\r\n                'fps.30': '30 FPS',\r\n                'fps.60': '60 FPS',\r\n                'fps.120': '120 FPS',\r\n                'fps.unlimited': 'Illimité',\r\n                \r\n                // Boutons\r\n                'button.saveChanges': 'Enregistrer',\r\n                'button.cancel': 'Annuler',\r\n                'button.reset': 'Réinitialiser',\r\n                'button.testSound': 'Tester Son',\r\n                'button.start': 'Commencer',\r\n                'button.back': 'Retour',\r\n                \r\n                // Notifications\r\n                'notify.optionsSaved': 'Options enregistrées avec succès',\r\n                'notify.optionsReset': 'Options réinitialisées',\r\n                'notify.soundTest': 'Lecture de l\\'effet sonore',\r\n                'notify.nameRequired': 'Vous devez entrer un nom',\r\n                'notify.specRequired': 'Sélectionnez une spécialisation',\r\n                \r\n                // Parties sauvegardées\r\n                'save.empty': 'Emplacement vide',\r\n                'save.level': 'Niveau',\r\n                \r\n                // Confirmations\r\n                'confirm.resetOptions': 'Êtes-vous sûr de vouloir réinitialiser toutes les options aux valeurs par défaut?',\r\n                'confirm.exit': 'Êtes-vous sûr de vouloir quitter?'\r\n            }\r\n        };\r\n    }\r\n    \r\n    /**\r\n     * Cambia el idioma actual\r\n     * @param {string} lang - Código de idioma ('es', 'en', 'fr')\r\n     */\r\n    setLanguage(lang) {\r\n        if (this.translations[lang]) {\r\n            this.currentLanguage = lang;\r\n            document.documentElement.setAttribute('lang', lang);\r\n            \r\n            // Actualizar la clase del idioma en el body\r\n            document.body.className = document.body.className\r\n                .replace(/lang-[a-z]{2}/g, '')\r\n                .trim();\r\n            document.body.classList.add(`lang-${lang}`);\r\n            \r\n            // Disparar evento de cambio de idioma\r\n            const event = new CustomEvent('languageChanged', { \r\n                detail: { language: lang } \r\n            });\r\n            document.dispatchEvent(event);\r\n            \r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    \r\n    /**\r\n     * Obtiene un texto traducido\r\n     * @param {string} key - Clave de traducción \r\n     * @param {Object} params - Parámetros para reemplazar en el texto\r\n     * @returns {string} Texto traducido\r\n     */\r\n    getText(key, params = {}) {\r\n        // Obtener traducción del idioma actual\r\n        let text = this.translations[this.currentLanguage][key];\r\n        \r\n        // Si no existe, intentar con el idioma por defecto\r\n        if (!text && this.currentLanguage !== 'es') {\r\n            text = this.translations['es'][key];\r\n        }\r\n        \r\n        // Si sigue sin existir, devolver la clave\r\n        if (!text) {\r\n            console.warn(`No se encontró traducción para: ${key}`);\r\n            return key;\r\n        }\r\n        \r\n        // Reemplazar parámetros si hay\r\n        if (params) {\r\n            Object.keys(params).forEach(param => {\r\n                text = text.replace(`{${param}}`, params[param]);\r\n            });\r\n        }\r\n        \r\n        return text;\r\n    }\r\n    \r\n    /**\r\n     * Traduce todos los elementos del DOM con atributo data-i18n\r\n     */\r\n    translatePage() {\r\n        const elements = document.querySelectorAll('[data-i18n]');\r\n        elements.forEach(element => {\r\n            const key = element.dataset.i18n;\r\n            element.textContent = this.getText(key);\r\n        });\r\n    }\r\n}\r\n\r\n// Instancia singleton para toda la aplicación\r\nlet localizationInstance = null;\r\n\r\nexport function getLocalization() {\r\n    if (!localizationInstance) {\r\n        localizationInstance = new Localization();\r\n    }\r\n    return localizationInstance;\r\n}\r\n"
        }
    ]
}